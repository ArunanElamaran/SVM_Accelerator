#!/bin/bash

# Define values for x0 and x1
x0_values=(
# 6-12 precision
# "000101000000000000"
# "000101100000000000"
# "000100111001100110"
# "000100011001100110"
# "000101000110011010"
# "000101000000000000"
# "000100100000000000"
# "000100011001100110"
# "000101000000000000"
# "000101000110011010"
# "000100110011001101"
# "000101000110011010"
# "000100100110011010"
# "000101010011001101"
# "000101000000000000"
# "000110000000000000"
# "000110101100110011"
# "000110010011001101"
# "000101100110011010"
# "000101100000000000"
# "000101100000000000"
# "000110000110011010"
# "000101110011001101"
# "000101000000000000"
# "000101100110011010"
# "000101101100110011"
# "000101101100110011"
# "000110001100110011"
# "000101000110011010"
# "000101101100110011"
# 5-2 trimmed precision
"0010100"
"0010110"
"0010100"
"0010010"
"0010100"
"0010100"
"0010010"
"0010010"
"0010100"
"0010100"
"0010011"
"0010100"
"0010010"
"0010101"
"0010100"
"0011000"
"0011011"
"0011001"
"0010110"
"0010110"
"0010110"
"0011000"
"0010111"
"0010100"
"0010110"
"0010111"
"0010111"
"0011001"
"0010100"
"0010111"
)

x1_values=(
# 6-12 precision
# "000011001100110011"
# "000011100000000000"
# "000011100110011010"
# "000011000000000000"
# "000011011001100110"
# "000011100000000000"
# "000010010011001101"
# "000011001100110011"
# "000011100000000000"
# "000011110011001101"
# "000011000000000000"
# "000011110011001101"
# "000011001100110011"
# "000011101100110011"
# "000011010011001101"
# "000011011001100110"
# "000011000110011010"
# "000010010011001101"
# "000011000000000000"
# "000010100000000000"
# "000010100110011010"
# "000011000000000000"
# "000010100110011010"
# "000010010011001101"
# "000010101100110011"
# "000011000000000000"
# "000010111001100110"
# "000010111001100110"
# "000010100000000000"
# "000010110011001101"
# 5-2 trimmed precision
"0001101"
"0001110"
"0001110"
"0001100"
"0001110"
"0001110"
"0001001"
"0001101"
"0001110"
"0001111"
"0001100"
"0001111"
"0001101"
"0001111"
"0001101"
"0001110"
"0001100"
"0001001"
"0001100"
"0001010"
"0001010"
"0001100"
"0001010"
"0001001"
"0001011"
"0001100"
"0001100"
"0001100"
"0001010"
"0001011"
)

# Helper to generate a single file
generate_rom_file() {
    local type=$1
    local index=$2
    local value=$3
    local filename="rom_${type}_${index}.sv"
    local module="rom_${type}_${index}"

    echo "Generating $filename..."

    {
        echo "module ${module}("
        echo "    input logic clk,"
        echo "    input logic [4:0] addr,"
        echo "    output logic [6:0] q"
        echo ");"
        echo "    reg [6:0] mem [31:0] /* synthesis ramstyle = \"M9K\" */;"
        echo ""
        echo "    initial begin"
        echo "        mem[0] = 7'b${value};"
        for i in $(seq 1 31); do
            echo "        mem[$i] = 7'b0000000;"
        done
        echo "    end"
        echo ""
        echo "    always @(posedge clk) begin"
        echo "        q <= mem[addr];"
        echo "    end"
        echo "endmodule"
    } > "$filename"
}

# Generate all x0 ROMs
for i in "${!x0_values[@]}"; do
    generate_rom_file x0 "$i" "${x0_values[$i]}"
done

# Generate all x1 ROMs
for i in "${!x1_values[@]}"; do
    generate_rom_file x1 "$i" "${x1_values[$i]}"
done

echo "Finished generating 60 ROM files."